**泡泡糖克隆函数**

**步骤一、下载环境工程包：点击下载**

**步骤二、导入项目工程：**



​    **1）解压下载的环境工程包**

​    **2）右键->Import->Existing projects into WorkSpace->Next**

![QQ截图20160316180709.png](http://www.csgmooc.com/ueditor/jsp/upload/image/20160316/1458123136477091794.png)



   3**）在Select root directory一栏点击Browse…，选择解压后的工程包PRJ_BU2_JAVA_004**

   **4）确认勾选Copy projects into workspace，点击Finish**



**![QQ截图20160316180726.png](http://www.csgmooc.com/ueditor/jsp/upload/image/20160316/1458123160701020595.png)**

**业务说明：**

​        本场景主要用于查找某个【被点击】的泡泡糖四周是否存在【同色】泡泡糖。将获得的所有【同色】

泡泡糖存储于集合中，我们将该集合称为：**“待消除泡泡糖” 集合**

![图片8.png](http://www.csgmooc.com/ueditor/jsp/upload/image/20160316/1458186282101016672.png) 

图 4-1

**实现思路：**

2-1. 当界面某个泡泡糖【被点击】时，游戏界面会调用服务类中的tobeClearedStars方法。

2-2. tobeClearedStars方法负责检查【完整泡泡糖列表】。

2-3. 检查时，需将【被点击】泡泡糖四周【同色】泡泡糖保存入**“待消除泡泡糖” 集合中**。

**核心组件介绍：**

![图片9.png](http://www.csgmooc.com/ueditor/jsp/upload/image/20160316/1458186286642046098.png) 

图 4-2



3-1. MainForm - 游戏界面类（本场景无需实现）：

负责游戏数据显示、响应用户在界面上的各类操作。

3-2. StarEventHandler – 鼠标事件处理类（本场景无需实现）：

负责处理鼠标在游戏界面的各类点击事件。

3-3. StarServiceImpl - 游戏业务类：

负责游戏相关逻辑计算，例如：泡泡糖移动、消除、分数计算等操作。

**3-4. StarServiceImpl类中的tobeClearedStars：**

该方法主要通过调用lookupByPath方法查找【被点击】泡泡糖四周【同色】泡泡糖。

3-5. tobeClearedStars的【Star base】参数 – 【被点击】的泡泡糖对象：

当前场景描述为：被用户点击的泡泡糖，由页面传递给服务类。

3-6. tobeClearedStars的【StarList mCurrent】参数 – 界面【完整的泡泡糖列表】：

当前场景描述为：界面10 * 10泡泡糖矩阵对应的【完整的泡泡糖列表】，在未执行消除操作前，

该集合始终保持着100个随机颜色的泡泡糖。

该集合由场景PRJ-BU2-JAVA-003实现的createStars函数创建。

3-7. tobeClearedStars的StarList返回值 - 【待消除泡泡糖】集合：

用于保持所有“待消除泡泡糖”的集合。

**3-8. StarServiceImpl类中的lookupByPath：**

该方法主要负责检查【被点击】泡泡糖的左、右、上、下四格内存放的泡泡糖是否为【同色】：

3-8.1. 若是，则以当前【被搜索到】的泡泡糖为基准，再次调用lookupByPath方法作进一步的查

找。

3-8.2. 若不是，则从其他方向执行搜索操作。

**了解更多：**

请参考《消灭泡泡糖 - 需求说明文档》。

**前置条件：**

5-1. 前置场景：PRJ-BU2-JAVA-003 – 随机显示泡泡糖。

5-2. 必备知识与技能：

5-2.1.  Java基本语法（变量、变量类型、运算符、for循环、if条件判断）。

5-2-2.  Java面向对象编程技能（工具类、引入包、递归调用）。

**1、任务描述：** 

1-1. 【克隆对象】：意指以某个对象的属性与属性值为基础，创建一个全新的对象，其结构、属性、属

​        性值与源对象完全一致。

1-2. 【克隆对象】和对象引用存在本质差异，【克隆对象】（图6-1）是创建了一个全新对象，它拥有

​        独立的存储空间和引用对象；而对象引用（图6-2）则是多个引用对象访问同一块存储空间。

![图片10.png](http://www.csgmooc.com/ueditor/jsp/upload/image/20160316/1458186591867099928.png) 

图 6-1

![图片11.png](http://www.csgmooc.com/ueditor/jsp/upload/image/20160316/1458186597436098993.png) 

图 6-2

1-3. 当前场景需要检索游戏界面上【完整泡泡糖集合】（A）中与【被点击】泡泡糖同色的对象，并将

​        同色泡泡糖存储于【待消除泡泡糖集合】（B）中。

1-4. 从1-3可知，为了实现泡泡糖消除功能，我们需要将满足消除条件的【同色】泡泡糖从A集合“搬

​        运”到B集合，为保证泡泡糖在A和B两个集合中独立存在，我们需要在“搬运”前，对被“搬运”

​        的泡泡糖进行克隆操作。

**2、推荐步骤：**

2-1. 定位到工具类：cn.campsg.practical.bubble.util.StarsUtil。

2-2. 新建一个克隆泡泡糖的方法clone

2-2.1. 方法为公共静态函数。

2-2.2. 入参为待克隆的Star对象。

2-3. 新建一个Star对象，该对象为源对象的克隆体。

2-4. 将源对象的行坐标、列坐标、类型依次赋值给新建的Star对象。



2-5. 返回克隆对象。

**3、验证与测试：**

3-1. 在当前StarsUtil类中创建一个main函数，作为测试的程序入口。

3-2. 新建一个Star对象，作为源泡泡糖对象，并设置坐标为(5,5)，颜色为红色。

3-3. 调用clone方法得到一个克隆对象。

3-4. 向控制台输出源对象内容（直接输出泡泡糖对象即可）。

3-5. 向控制台输出克隆对象内容（直接输出泡泡糖对象即可）。

3-6. 使用equals方法对两泡泡糖进行比较并显示在控制台，用于测试两对象是否相同。

3-7. 使用equals方法对两泡泡糖的position属性对象进行比较并显示在控制台，用于测试Position属性

​        对象是否相同。

3-8. 观察控制台是否显示以下测试内容：

![图片12.png](http://www.csgmooc.com/ueditor/jsp/upload/image/20160316/1458186605901021804.png) 

图 6-1